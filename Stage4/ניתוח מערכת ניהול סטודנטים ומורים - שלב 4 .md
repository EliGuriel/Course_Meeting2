<div dir="rtl">

# × ×™×ª×•×— ××¢×¨×›×ª × ×™×”×•×œ ×¡×˜×•×“× ×˜×™× ×•××•×¨×™× - ×©×œ×‘ 4

## ×ª×•×›×Ÿ ×¢× ×™×™× ×™×
1. [×¡×§×™×¨×” ×›×œ×œ×™×ª](#×¡×§×™×¨×”-×›×œ×œ×™×ª)
2. [××¨×›×™×˜×§×˜×•×¨×ª ×”××¢×¨×›×ª](#××¨×›×™×˜×§×˜×•×¨×ª-×”××¢×¨×›×ª)
3. [××•×“×œ ×”× ×ª×•× ×™×](#××•×“×œ-×”× ×ª×•× ×™×)
4. [×™×—×¡×™ Many-to-Many](#×™×—×¡×™-many-to-many)
5. [StandardResponse ×•×× ×’× ×•×Ÿ ×ª×’×•×‘×•×ª ××—×™×“](#standardresponse-×•×× ×’× ×•×Ÿ-×ª×’×•×‘×•×ª-××—×™×“)
6. [×˜×™×¤×•×œ ×‘×©×’×™××•×ª](#×˜×™×¤×•×œ-×‘×©×’×™××•×ª)
7. [×“×•×’×××•×ª ×©××™×œ×ª×•×ª HTTP ×¢×™×§×¨×™×•×ª](#×“×•×’×××•×ª-×©××™×œ×ª×•×ª-http-×¢×™×§×¨×™×•×ª)
8. [×ª×™×§×•×£ × ×ª×•× ×™×](#×ª×™×§×•×£-× ×ª×•× ×™×)
9. [×¡×™×›×•×](#×¡×™×›×•×)

## ×¡×§×™×¨×” ×›×œ×œ×™×ª

××¢×¨×›×ª × ×™×”×•×œ ×”×¡×˜×•×“× ×˜×™× ×•×”××•×¨×™× ×‘×©×œ×‘ 4 ×”×™× ××¤×œ×™×§×¦×™×™×ª Spring Boot ×”××××©×ª REST API ×œ× ×™×”×•×œ ××™×“×¢ ××§×“××™. ×‘×©×œ×‘ ×–×” ×”××¢×¨×›×ª ×”×•×¨×—×‘×” ×œ×ª××•×š ×‘×™×—×¡×™ Many-to-Many ×‘×™×Ÿ ××•×¨×™× ×œ×¡×˜×•×“× ×˜×™×, ×›×š ×©×¡×˜×•×“× ×˜ ×™×›×•×œ ×œ×œ××•×“ ××¦×œ ××¡×¤×¨ ××•×¨×™× ×•×›×œ ××•×¨×” ×™×›×•×œ ×œ×œ××“ ××¡×¤×¨ ×¡×˜×•×“× ×˜×™×.

# ××¨×›×™×˜×§×˜×•×¨×ª ×”××¢×¨×›×ª

×”××¢×¨×›×ª ××™×™×©××ª ××¨×›×™×˜×§×˜×•×¨×ª ×©×›×‘×•×ª (Layered Architecture) ×”××¤×¨×™×“×” ×‘×™×Ÿ ×”×ª×¤×§×•×“×™× ×”×©×•× ×™× ×•×××¤×©×¨×ª ×ª×—×–×•×§×”, ×”×¨×—×‘×” ×•×‘×“×™×§×” ×§×œ×•×ª ×™×•×ª×¨.

## ×©×›×‘×•×ª ×”××¢×¨×›×ª

### ğŸŒ Controllers
**×ª×¤×§×™×“**: ×§×‘×œ×ª ×‘×§×©×•×ª HTTP ×•×”×—×–×¨×ª ×ª×©×•×‘×•×ª ×‘××‘× ×” ××—×™×“
* `StudentController` - × ×™×”×•×œ ×‘×§×©×•×ª ×”×§×©×•×¨×•×ª ×œ×¡×˜×•×“× ×˜×™×
* `StudentDetailsController` - × ×™×”×•×œ ×‘×§×©×•×ª ×”×§×©×•×¨×•×ª ×œ×¤×¨×˜×™× × ×•×¡×¤×™× ×©×œ ×¡×˜×•×“× ×˜×™×
* `TeacherController` - × ×™×”×•×œ ×‘×§×©×•×ª ×”×§×©×•×¨×•×ª ×œ××•×¨×™×

### âš™ï¸ Services
**×ª×¤×§×™×“**: ×”×›×œ×ª ×”×œ×•×’×™×§×” ×”×¢×¡×§×™×ª ×©×œ ×”××¢×¨×›×ª
* `StudentService` ×•-`StudentServiceImpl` - ×˜×™×¤×•×œ ×‘×œ×•×’×™×§×” ×”×¢×¡×§×™×ª ×©×œ ×¡×˜×•×“× ×˜×™×
* `StudentDetailsService` ×•-`StudentDetailsServiceImpl` - ×˜×™×¤×•×œ ×‘×œ×•×’×™×§×” ×©×œ ×¤×¨×˜×™ ×¡×˜×•×“× ×˜×™×
* `TeacherService` ×•-`TeacherServiceImpl` - ×˜×™×¤×•×œ ×‘×œ×•×’×™×§×” ×”×¢×¡×§×™×ª ×©×œ ××•×¨×™×

### ğŸ’¾ Repositories
**×ª×¤×§×™×“**: ×’×™×©×” ×œ××¡×“ ×”× ×ª×•× ×™×
* `StudentRepository` - ×’×™×©×” ×œ× ×ª×•× ×™ ×¡×˜×•×“× ×˜×™×
* `StudentDetailsRepository` - ×’×™×©×” ×œ×¤×¨×˜×™× × ×•×¡×¤×™× ×©×œ ×¡×˜×•×“× ×˜×™×
* `TeacherRepository` - ×’×™×©×” ×œ× ×ª×•× ×™ ××•×¨×™×

### ğŸ“‹ Entities
**×ª×¤×§×™×“**: ×”×’×“×¨×ª ××•×“×œ ×”× ×ª×•× ×™×
* `Student` - ×™×©×•×ª ×”××™×™×¦×’×ª ×¡×˜×•×“× ×˜
* `StudentDetails` - ×™×©×•×ª ×”××™×™×¦×’×ª ×¤×¨×˜×™× × ×•×¡×¤×™× ×©×œ ×¡×˜×•×“× ×˜
* `Teacher` - ×™×©×•×ª ×”××™×™×¦×’×ª ××•×¨×”

### ğŸ“¦ DTOs
**×ª×¤×§×™×“**: ×”×¢×‘×¨×ª × ×ª×•× ×™× ×‘×™×Ÿ ×©×›×‘×•×ª ×”××¢×¨×›×ª
* `StudentDto` - ××‘× ×” ×œ×”×¢×‘×¨×ª × ×ª×•× ×™ ×¡×˜×•×“× ×˜
* `StudentDetailsDto` - ××‘× ×” ×œ×”×¢×‘×¨×ª ×¤×¨×˜×™× × ×•×¡×¤×™× ×©×œ ×¡×˜×•×“× ×˜
* `TeacherDto` - ××‘× ×” ×œ×”×¢×‘×¨×ª × ×ª×•× ×™ ××•×¨×” ××œ××™×
* `TeacherBasicDto` - ××‘× ×” ×œ×”×¢×‘×¨×ª × ×ª×•× ×™ ××•×¨×” ×‘×¡×™×¡×™×™×

### ğŸ“¤ Responses
**×ª×¤×§×™×“**: ×”×’×“×¨×ª ××‘× ×” ×ª×’×•×‘×” ××—×™×“
* `StandardResponse` - ××‘× ×” ×¡×˜× ×“×¨×˜×™ ×œ×ª×©×•×‘×•×ª
* `GlobalResponseHandler` - ××˜×¤×œ ×’×œ×•×‘×œ×™ ×‘×ª×©×•×‘×•×ª

### âš ï¸ Exceptions
**×ª×¤×§×™×“**: ×”×’×“×¨×ª ×—×¨×™×’×™× ×¡×¤×¦×™×¤×™×™× ×•×× ×’× ×•×Ÿ ×˜×™×¤×•×œ ×‘×©×’×™××•×ª
* `NotExists` - ×—×¨×™×’ ×œ××§×¨×” ×©×™×©×•×ª ×œ× ×§×™×™××ª
* `AlreadyExists` - ×—×¨×™×’ ×œ××§×¨×” ×©×™×©×•×ª ×›×‘×¨ ×§×™×™××ª
* `StudentIdAndIdMismatch` - ×—×¨×™×’ ×œ××§×¨×” ×©×œ ××™ ×”×ª×××” ×‘××–×”×™×
* `InvalidRequestException` - ×—×¨×™×’ ×œ×‘×§×©×” ×œ× ×ª×§×™× ×”
* `GlobalExceptionHandler` - ××˜×¤×œ ×’×œ×•×‘×œ×™ ×‘×—×¨×™×’×™×

## ×™×ª×¨×•× ×•×ª ×”××¨×›×™×˜×§×˜×•×¨×”
* **××•×“×•×œ×¨×™×•×ª** - ×”×¤×¨×“×” ×‘×¨×•×¨×” ×‘×™×Ÿ ×¨×›×™×‘×™×
* **×ª×—×–×•×§×ª×™×•×ª** - ×§×œ ×™×•×ª×¨ ×œ×©× ×•×ª ×•×œ×ª×—×–×§ ×›×œ ×©×›×‘×” ×‘× ×¤×¨×“
* **×‘×“×™×§×ª×™×•×ª** - × ×™×ª×Ÿ ×œ×‘×“×•×§ ×›×œ ×©×›×‘×” ×‘××•×¤×Ÿ ×¢×¦×××™
* **×”×¨×—×‘×”** - × ×™×ª×Ÿ ×œ×”×•×¡×™×£ ×¤×•× ×§×¦×™×•× ×œ×™×•×ª ×—×“×©×” ×‘×§×œ×•×ª
* **×”×¤×¨×“×ª ××—×¨×™×•×ª** - ×›×œ ×©×›×‘×” ××—×¨××™×ª ×¢×œ ×”×™×‘×˜ ×¡×¤×¦×™×¤×™ ×©×œ ×”××¢×¨×›×ª


# ××•×“×œ ×”× ×ª×•× ×™×

××•×“×œ ×”× ×ª×•× ×™× ×©×œ ×”××¢×¨×›×ª ××‘×•×¡×¡ ×¢×œ ×©×œ×•×© ×™×©×•×™×•×ª ×¢×™×§×¨×™×•×ª ×”××§×•×©×¨×•×ª ×‘×™× ×™×”×Ÿ ×‘×™×—×¡×™× ××•×’×“×¨×™×.

## ×™×©×•×™×•×ª ×”××¢×¨×›×ª

### ğŸ§‘â€ğŸ“ Student
**×ª×™××•×¨**: ××›×™×œ ××ª ×”××™×“×¢ ×”×‘×¡×™×¡×™ ×©×œ ×”×¡×˜×•×“× ×˜ ×‘××¢×¨×›×ª.

| ×©×“×” | ×¡×•×’ | ×ª×™××•×¨ |
|------|------|---------|
| `id` | int | ××–×”×” ×™×™×—×•×“×™ ×©×œ ×”×¡×˜×•×“× ×˜ |
| `firstName` | string | ×©× ×¤×¨×˜×™ |
| `lastName` | string | ×©× ××©×¤×—×” |
| `age` | int | ×’×™×œ |
| `email` | string | ×›×ª×•×‘×ª ×“×•×"×œ |

### ğŸ“‹ StudentDetails
**×ª×™××•×¨**: ××›×™×œ ××™×“×¢ ××•×¨×—×‘ ×•××©×œ×™× ×¢×œ ×”×¡×˜×•×“× ×˜.

| ×©×“×” | ×¡×•×’ | ×ª×™××•×¨ |
|------|------|---------|
| `id` | int | ××–×”×” ×™×™×—×•×“×™ ×©×œ ×¤×¨×˜×™ ×”×¡×˜×•×“× ×˜ |
| `address` | string | ×›×ª×•×‘×ª ××’×•×¨×™× ××œ××” |
| `phone` | string | ××¡×¤×¨ ×˜×œ×¤×•×Ÿ |
| `emergencyContact` | string | ×¤×¨×˜×™ ××™×© ×§×©×¨ ×œ×©×¢×ª ×—×™×¨×•× |

### ğŸ‘¨â€ğŸ« Teacher
**×ª×™××•×¨**: ××™×™×¦×’ ××ª ×”××•×¨×” ×‘××¢×¨×›×ª.

| ×©×“×” | ×¡×•×’ | ×ª×™××•×¨ |
|------|------|---------|
| `id` | int | ××–×”×” ×™×™×—×•×“×™ ×©×œ ×”××•×¨×” |
| `name` | string | ×©× ××œ× |
| `subject` | string | ×ª×—×•× ×”×ª××—×•×ª/××§×¦×•×¢ ×”×•×¨××” |


## ×™×—×¡×™× ×‘×™×Ÿ ×”×™×©×•×™×•×ª

</div>

``` mermaid
classDiagram
    class Student {
        +int id
        +string firstName
        +string lastName
        +int age
        +string email
    }
    
    class StudentDetails {
        +int id
        +string address
        +string phone
        +string emergencyContact
    }
    
    class Teacher {
        +int id
        +string name
        +string subject
    }
    
    Student "1" -- "1" StudentDetails : contains (bidirectional)
    Student "*" -- "*" Teacher : studies with (bidirectional)
    Teacher "*" -- "*" Student : teaches (bidirectional)
    
    note for Student "Student entity in system"
    note for StudentDetails "Additional student information" 
    note for Teacher "Teacher information and specialization"
```


![stage4_db.png](stage4_db.png)


<div dir="rtl">

### Student â†” StudentDetails
**×¡×•×’ ×™×—×¡**: ×—×“-×—×“ (One-to-One)  
**×ª×™××•×¨**: ×œ×›×œ ×¡×˜×•×“× ×˜ ×™×© ×‘×“×™×•×§ ×¡×˜ ××—×“ ×©×œ ×¤×¨×˜×™× × ×•×¡×¤×™×, ×•×œ×›×œ ×¡×˜ ×¤×¨×˜×™× ×™×© ×‘×“×™×•×§ ×¡×˜×•×“× ×˜ ××—×“.

### Student â†” Teacher
**×¡×•×’ ×™×—×¡**: ×¨×‘×™×-×œ×¨×‘×™× (Many-to-Many)  
**×ª×™××•×¨**: ×¡×˜×•×“× ×˜ ×™×›×•×œ ×œ×œ××•×“ ××¦×œ ××¡×¤×¨ ××•×¨×™×, ×•××•×¨×” ×™×›×•×œ ×œ×œ××“ ××¡×¤×¨ ×¡×˜×•×“× ×˜×™×.  
**××™××•×©**: ×™×—×¡ ×¨×‘×™×-×œ×¨×‘×™× ××—×™×™×‘ ×˜×‘×œ×ª ×§×™×©×•×¨ ×‘××¡×“ ×”× ×ª×•× ×™×.

## ×™×ª×¨×•× ×•×ª ×”××•×“×œ

* **×©×œ××•×ª × ×ª×•× ×™×**: ×”×¤×¨×“×” ×œ×•×’×™×ª ×‘×™×Ÿ ×¡×•×’×™ ××™×“×¢ ×©×•× ×™×
* **×’××™×©×•×ª**: ×××¤×©×¨ ×”×¨×—×‘×” ×¢×ª×™×“×™×ª ×©×œ ×›×œ ×™×©×•×ª ×‘× ×¤×¨×“
* **×‘×™×¦×•×¢×™×**: ××‘× ×” ×”×ª×•××š ×‘×©××™×œ×ª×•×ª ×™×¢×™×œ×•×ª
* **×ª××™××•×ª ×œ×“×¨×™×©×•×ª ×¢×¡×§×™×•×ª**: ×ª×•××š ×‘×ª×”×œ×™×›×™× ×”×¢×¡×§×™×™× ×©×œ ××¢×¨×›×ª ×—×™× ×•×›×™×ª



## ×™×—×¡×™ Many-to-Many

×‘×©×œ×‘ 4, ×”××¢×¨×›×ª ××™×™×©××ª ×™×—×¡×™ Many-to-Many ×‘×™×Ÿ ××•×¨×™× ×œ×¡×˜×•×“× ×˜×™×, ×›×š ×©×¡×˜×•×“× ×˜ ×™×›×•×œ ×œ×œ××•×“ ××¦×œ ××¡×¤×¨ ××•×¨×™× ×•×›×œ ××•×¨×” ×™×›×•×œ ×œ×œ××“ ××¡×¤×¨ ×¡×˜×•×“× ×˜×™×:

</div>

<div dir="ltr">

```java
// Student Entity
@ManyToMany(mappedBy = "students")
private Set<Teacher> teachers = new HashSet<>();

// Teacher Entity
@ManyToMany
@JoinTable(
    name = "teacher_student",
    joinColumns = @JoinColumn(name = "teacher_id"),
    inverseJoinColumns = @JoinColumn(name = "student_id")
)
@ToString.Exclude
private Set<Student> students = new HashSet<>();
```

</div>

<div dir="rtl">

× ×™×”×•×œ ×”×™×—×¡×™× ××ª×‘×¦×¢ ×‘×–×”×™×¨×•×ª ×‘×©×›×‘×ª ×”×©×™×¨×•×ª:

</div>

<div dir="ltr">

```java
// StudentServiceImpl - Assigning a teacher to a student
@Override
@Transactional
public StudentDto assignTeacherToStudent(Long studentId, Long teacherId, String notes) {
    Student student = studentRepository.findById(studentId)
            .orElseThrow(() -> new NotExists("Student with id " + studentId + " does not exist"));

    Teacher teacher = teacherRepository.findById(teacherId)
            .orElseThrow(() -> new NotExists("Teacher with id " + teacherId + " does not exist"));

    // Check if already assigned
    if (student.getTeachers().contains(teacher)) {
        throw new AlreadyExists("Teacher is already assigned to this student");
    }

    // Assign teacher to student
    student.getTeachers().add(teacher);
    teacher.getStudents().add(student);
    
    studentRepository.save(student);

    return studentMapper.toDto(student);
}
```

```java
// TeacherServiceImpl - Updating teacher with students
@Override
@Transactional
public TeacherDto updateTeacher(Long id, TeacherDto teacherDto) {
    Teacher teacher = teacherRepository.findById(id)
            .orElseThrow(() -> new NotExists("Teacher with id " + id + " does not exist"));

    teacherMapper.updateEntityFromDto(teacher, teacherDto);

    if (teacherDto.getStudentIds() != null) {
        // Get current students
        Set<Student> currentStudents = teacher.getStudents();
        
        // Get new students from IDs
        Set<Student> newStudents = teacherDto.getStudentIds().stream()
                .map(studentId -> studentRepository.findById(studentId)
                        .orElseThrow(() -> new NotExists("Student with id " + studentId + " not found")))
                .collect(Collectors.toSet());
        
        // Remove teacher from students that are no longer associated
        for (Student student : currentStudents) {
            if (!newStudents.contains(student)) {
                student.getTeachers().remove(teacher);
            }
        }
        
        // Add teacher to new students
        for (Student student : newStudents) {
            if (!currentStudents.contains(student)) {
                student.getTeachers().add(teacher);
            }
        }
        
        // Update the teacher's students
        teacher.setStudents(newStudents);
    }

    Teacher updatedTeacher = teacherRepository.save(teacher);
    return teacherMapper.toDto(updatedTeacher);
}
```

</div>

<div dir="rtl">

## StandardResponse ×•×× ×’× ×•×Ÿ ×ª×’×•×‘×•×ª ××—×™×“

×”××¢×¨×›×ª ××™×™×©××ª ××‘× ×” ×ª×’×•×‘×” ××—×™×“ ×‘×××¦×¢×•×ª `StandardResponse`. ×›×œ ×‘×§×¨ ××—×–×™×¨ ×ª×’×•×‘×•×ª ×‘××‘× ×” ××—×™×“:

</div>

<div dir="ltr">

```java
@GetMapping("/{id}")
public StandardResponse getStudentById(@PathVariable Long id) {
    StudentDto studentDto = studentService.getStudentDtoById(id);
    return new StandardResponse("success", studentDto, null);
}

@PostMapping()
public ResponseEntity<StandardResponse> addStudent(@Valid @RequestBody StudentDto studentDto) {
    StudentDto addedDto = studentService.addStudentAndReturnDto(studentDto);

    URI location = ServletUriComponentsBuilder
            .fromCurrentRequest()
            .path("/{id}")
            .buildAndExpand(addedDto.getId())
            .toUri();

    StandardResponse response = new StandardResponse("success", addedDto, null);
    return ResponseEntity.created(location).body(response);
}
```

</div>

<div dir="rtl">

## ×˜×™×¤×•×œ ×‘×©×’×™××•×ª

×”××¢×¨×›×ª ×›×•×œ×œ×ª ×× ×’× ×•×Ÿ ×˜×™×¤×•×œ ×‘×©×’×™××•×ª ××§×™×£ ×‘×××¦×¢×•×ª `GlobalExceptionHandler`:

</div>

<div dir="ltr">

```java
@ControllerAdvice
public class GlobalExceptionHandler {

    /**
     * takes care of the exception when a resource is not found, 404 Not Found
     */
    @ExceptionHandler(NotExists.class)
    public ResponseEntity<StandardResponse> handleNotExists(NotExists ex, WebRequest request) {
        Map<String, String> details = new HashMap<>();
        details.put("type", "Resource Not Found");
        details.put("message", ex.getMessage());
        
        StandardResponse response = new StandardResponse("error", null, details);
        return new ResponseEntity<>(response, HttpStatus.NOT_FOUND);
    }

    /**
     * takes care of the exception when a resource already exists, 409 Conflict
     */
    @ExceptionHandler(AlreadyExists.class)
    public ResponseEntity<StandardResponse> handleAlreadyExists(AlreadyExists ex, WebRequest request) {
        Map<String, String> details = new HashMap<>();
        details.put("type", "Resource Conflict");
        details.put("message", ex.getMessage());
        
        StandardResponse response = new StandardResponse("error", null, details);
        return new ResponseEntity<>(response, HttpStatus.CONFLICT);
    }

    // Additional exception handlers...
}
```

</div>

<div dir="rtl">

## ×“×•×’×××•×ª ×©××™×œ×ª×•×ª HTTP ×¢×™×§×¨×™×•×ª

### ×§×‘×œ×ª ×”×ª×œ××™×“×™× ×©×œ ××•×¨×”

</div>

<div dir="ltr">

```http
GET /teachers/1 HTTP/1.1
Host: localhost:8080
Accept: application/json
```

```json
{
  "status": "success",
  "data": {
    "id": 1,
    "name": "David Cohen",
    "subject": "Mathematics",
    "studentIds": [1, 2]
  },
  "error": null,
  "timestamp": "2023-07-25T14:30:15.123"
}
```

</div>

<div dir="rtl">

### ×§×‘×œ×ª ×”××•×¨×™× ×©×œ ×ª×œ××™×“

</div>

<div dir="ltr">

```http
GET /students/1/teachers HTTP/1.1
Host: localhost:8080
Accept: application/json
```

```json
{
  "status": "success",
  "data": [
    {
      "id": 1,
      "name": "David Cohen",
      "subject": "Mathematics"
    },
    {
      "id": 2,
      "name": "Sarah Levy",
      "subject": "Physics"
    }
  ],
  "error": null,
  "timestamp": "2023-07-25T14:32:45.789"
}
```

</div>

<div dir="rtl">

### ×”×§×¦××ª ××•×¨×” ×œ×ª×œ××™×“

</div>

<div dir="ltr">

```http
POST /students/3/teachers/2 HTTP/1.1
Host: localhost:8080
Accept: application/json
```

```json
{
  "status": "success",
  "data": {
    "id": 3,
    "firstName": "Noam",
    "lastName": "Mizrachi",
    "age": 20.7,
    "email": "noam.mizrachi@example.com",
    "details": {
      "id": 3,
      "address": "78 Weizmann St, Haifa",
      "phoneNumber": "+972531234567",
      "emergencyContactName": "Ruth Mizrachi",
      "emergencyContactPhone": "+972531234568"
    }
  },
  "error": null,
  "timestamp": "2023-07-25T14:34:12.456"
}
```

</div>

<div dir="rtl">

### ×“×•×’××” ×œ×©×’×™××” - × ×™×¡×™×•×Ÿ ×œ×”×§×¦×•×ª ××•×¨×” ×©×›×‘×¨ ××•×§×¦×” ×œ×ª×œ××™×“

</div>

<div dir="ltr">

```http
POST /students/1/teachers/1 HTTP/1.1
Host: localhost:8080
Accept: application/json
```

```json
{
  "status": "error",
  "data": null,
  "error": {
    "type": "Resource Conflict",
    "message": "Teacher is already assigned to this student"
  },
  "timestamp": "2023-07-25T14:35:20.123"
}
```

</div>

<div dir="rtl">

## ×ª×™×§×•×£ × ×ª×•× ×™×

×”××¢×¨×›×ª ××©×ª××©×ª ×‘×× ×•×˜×¦×™×•×ª Jakarta Validation ×œ×ª×™×§×•×£ × ×ª×•× ×™×:

### StudentDto

</div>

<div dir="ltr">

```java
@Data
@NoArgsConstructor
@AllArgsConstructor
public class StudentDto {
    private Long id;

    @NotBlank(message = "First name is required")
    @Size(min = 2, max = 50, message = "First name must be between 2 and 50 characters")
    private String firstName;

    @NotBlank(message = "Last name is required")
    @Size(min = 2, max = 50, message = "Last name must be between 2 and 50 characters")
    private String lastName;

    @Min(value = 0, message = "Age must be a positive number")
    private double age;

    @NotBlank(message = "Email is required")
    @Email(message = "Email should be valid")
    private String email;

    // Making sure to validate the nested object
    @Valid
    private StudentDetailsDto details;
}
```

</div>

<div dir="rtl">

### StudentDetailsDto

</div>

<div dir="ltr">

```java
@Data
@NoArgsConstructor
@AllArgsConstructor
public class StudentDetailsDto {
    private Long id;
    private Long studentId;

    @Size(max = 255, message = "Address must be less than 255 characters")
    private String address;

    // regex: for Israeli phone numbers
    @Pattern(regexp = "^\\+?(972|0)([23459]\\d{7}|5\\d{8})$",
            message = "Phone number must be a valid Israeli phone number (e.g., +972541234567 or 0541234567)")
    private String phoneNumber;

    @Size(max = 100, message = "Emergency contact name must be less than 100 characters")
    private String emergencyContactName;

    // regex: for Israeli phone numbers
    @Pattern(regexp = "^\\+?(972|0)([23459]\\d{7}|5\\d{8})$",
            message = "Emergency contact phone must be a valid Israeli phone number (e.g., +972541234567 or 0541234567)")
    private String emergencyContactPhone;
}
```

</div>

<div dir="rtl">

## ××‘× ×” × ×ª×•× ×™× - ××¢×‘×¨ ×œ×™×—×¡×™ Many-to-Many

×”××¢×‘×¨ ××™×—×¡×™ One-to-Many ×œ×™×—×¡×™ Many-to-Many ×‘×™×Ÿ ××•×¨×™× ×œ×¡×˜×•×“× ×˜×™× ×××¤×©×¨ ×™×•×ª×¨ ×’××™×©×•×ª ×‘××¢×¨×›×ª:

1. **×‘××•×“×œ ×”×§×•×“× (One-to-Many)**:
    - ×›×œ ×¡×˜×•×“× ×˜ ×©×™×™×š ×œ××•×¨×” ××—×“ ×‘×œ×‘×“
    - ×›×œ ××•×¨×” ×™×›×•×œ ×œ×œ××“ ××¡×¤×¨ ×¡×˜×•×“× ×˜×™×
    - ×”×™×—×¡ ×”×™×” ××™×•×¦×’ ×¢×œ ×™×“×™ ×©×“×” `teacher` ×‘×™×©×•×ª `Student`

2. **×‘××•×“×œ ×”× ×•×›×—×™ (Many-to-Many)**:
    - ×›×œ ×¡×˜×•×“× ×˜ ×™×›×•×œ ×œ×œ××•×“ ××¦×œ ××¡×¤×¨ ××•×¨×™×
    - ×›×œ ××•×¨×” ×™×›×•×œ ×œ×œ××“ ××¡×¤×¨ ×¡×˜×•×“× ×˜×™×
    - ×”×™×—×¡ ××™×•×¦×’ ×¢×œ ×™×“×™:
        - `Set<Teacher> teachers` ×‘×™×©×•×ª `Student`
        - `Set<Student> students` ×‘×™×©×•×ª `Teacher`
        - ×˜×‘×œ×ª ×§×©×¨ `teacher_student` ×‘××¡×“ ×”× ×ª×•× ×™×

×”×™×ª×¨×•× ×•×ª ×©×œ ×”××•×“×œ ×”×—×“×©:
- ××™×™×¦×’ ×˜×•×‘ ×™×•×ª×¨ ××ª ×”××¦×™××•×ª ×”××§×“××™×ª, ×‘×” ×¡×˜×•×“× ×˜×™× ×œ×•××“×™× ××¦×œ ××¡×¤×¨ ××•×¨×™×
- ×××¤×©×¨ ×’××™×©×•×ª ×‘× ×™×”×•×œ ×”×§×©×¨×™× ×‘×™×Ÿ ×¡×˜×•×“× ×˜×™× ×œ××•×¨×™×
- ×ª×•××š ×‘×ª×¨×—×™×©×™× ××•×¨×›×‘×™× ×™×•×ª×¨ ×©×œ × ×™×”×•×œ ××™×“×¢ ××§×“××™

## ×™×¦×™×¨×ª × ×ª×•× ×™ ×“×•×’××”

×”××¢×¨×›×ª ×›×•×œ×œ×ª `DataInitializer` ×©×××ª×—×œ ××ª ××¡×“ ×”× ×ª×•× ×™× ×¢× × ×ª×•× ×™ ×“×•×’××” ×©×œ ×¡×˜×•×“× ×˜×™×, ××•×¨×™× ×•×”×§×©×¨×™× ×‘×™× ×™×”×:

</div>

<div dir="ltr">

```java
@Component
public class DataInitializer implements CommandLineRunner {
    @Override
    @Transactional
    public void run(String... args) {
        // Check if there are already records in the database
        if (teacherRepository.count() == 0) {
            // Create teachers and students
            // ...
            
            // Assign students to teachers
            mathTeacher.getStudents().add(moshe);
            mathTeacher.getStudents().add(yael);
            moshe.getTeachers().add(mathTeacher);
            yael.getTeachers().add(mathTeacher);
            
            physicsTeacher.getStudents().add(moshe);
            physicsTeacher.getStudents().add(noam);
            moshe.getTeachers().add(physicsTeacher);
            noam.getTeachers().add(physicsTeacher);
            
            englishTeacher.getStudents().add(yael);
            englishTeacher.getStudents().add(noam);
            yael.getTeachers().add(englishTeacher);
            noam.getTeachers().add(englishTeacher);
            
            // Save entities
            // ...
        }
    }
}
```

</div>

<div dir="rtl">

## ×¡×™×›×•×

××¢×¨×›×ª × ×™×”×•×œ ×”×¡×˜×•×“× ×˜×™× ×•×”××•×¨×™× ×‘×©×œ×‘ 4 ××™×™×©××ª ×¢×§×¨×•× ×•×ª ××¨×›×™×˜×§×˜×•×¨×ª Spring Boot ××•×“×¨× ×™×ª, ×¢×:

1. **××¢×‘×¨ ×œ×™×—×¡×™ Many-to-Many** ×‘×™×Ÿ ××•×¨×™× ×œ×¡×˜×•×“× ×˜×™×
2. **×”×¤×¨×“×ª ××—×¨×™×•×ª** ×‘×™×Ÿ ×©×›×‘×•×ª ×”××¢×¨×›×ª ×”×©×•× ×•×ª
3. **××‘× ×” ×ª×’×•×‘×” ××—×™×“** ×‘×××¦×¢×•×ª StandardResponse
4. **×˜×™×¤×•×œ ×‘×©×’×™××•×ª ××§×™×£** ×¢× GlobalExceptionHandler
5. **×ª×™×§×•×£ × ×ª×•× ×™×** ×‘×××¦×¢×•×ª Jakarta Validation
6. **REST API** ××§×™×£ ×œ× ×™×”×•×œ ××™×“×¢ ××§×“××™

×”××¢×¨×›×ª ××“×’×™××” ×™×™×©×•× × ×›×•×Ÿ ×©×œ ×”×¤×¨×§×˜×™×§×•×ª ×”××•××œ×¦×•×ª ×‘×¤×™×ª×•×— Spring Boot, ×¢× ×“×’×© ×¢×œ ×ª×—×–×•×§×ª×™×•×ª, ×’××™×©×•×ª, ×•×‘×˜×™×—×•×ª × ×ª×•× ×™×.

</div>