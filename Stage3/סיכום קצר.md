<div dir="rtl">

# סיכום פרויקט ניהול סטודנטים ומורים - Stage3

## מה הפרויקט עושה בשלב זה?

ב-Stage3, המערכת ממשיכה להתפתח ומוסיפה ישות חדשה וקשרים חדשים:

* **ניהול מורים (`Teacher`):**
    * ניתן להוסיף, לקרוא, לעדכן ולמחוק מורים. לכל מורה יש שם ומקצוע.
* **קשר בין מורים לסטודנטים (One-to-Many):**
    * מורה אחד יכול ללמד מספר סטודנטים.
    * סטודנט אחד משויך למורה אחד בלבד.
    * המערכת מאפשרת לשייך סטודנט למורה, להסיר שיוך, ולראות איזה מורה משויך לסטודנט מסוים, או אילו סטודנטים משויכים למורה מסוים.
* **פעולות CRUD על סטודנטים ופרטיהם נמשכות:** כמו בשלבים קודמים, עם התאמות לטיפול בקשר למורה.

**מה עדיין אין בשלב זה:**
* הקשר בין מורים לסטודנטים הוא עדיין לא גמיש לחלוטין (לא מאפשר לסטודנט להיות משויך למספר מורים במקביל).

## איך הוא בנוי? (הארכיטקטורה)

הארכיטקטורה נשארת דומה לשלבים הקודמים, עם הרחבות לתמיכה בישות המורה והקשר החדש:

1.  **קומת הבקרים (Controllers):**
    * `StudentController`: הורחב לטפל בשיוך סטודנט למורה ובקבלת המורה של סטודנט.
    * `StudentDetailsController`: ללא שינוי משמעותי מ-Stage2.
    * **`TeacherController` (חדש):** בקר ייעודי לניהול מורים, כולל שיוך סטודנטים למורה.

2.  **קומת השירותים (Services):**
    * `StudentServiceImpl`: הורחב לטפל בלוגיקה של שיוך סטודנט למורה.
    * `StudentDetailsServiceImpl`: ללא שינוי משמעותי.
    * **`TeacherServiceImpl` (חדש):** לוגיקה עסקית לניהול מורים ושיוך סטודנטים.

3.  **קומת מאגרי המידע (Repositories):**
    * `StudentRepository`: ממשיך לנהל סטודנטים.
    * `StudentDetailsRepository`: ללא שינוי.
    * **`TeacherRepository` (חדש):** מאגר מידע למורים, כולל שאילתה לטעינת מורה עם הסטודנטים שלו (`findByIdWithStudents`).

4.  **קומת הישויות (Entities):**
    * `Student`: נוסף שדה `teacher` המייצג את הקשר `ManyToOne` לישות `Teacher`. הסטודנט הוא הבעלים של עמודת המפתח הזר (`teacher_id`).
    * `StudentDetails`: ללא שינוי.
    * **`Teacher` (חדש):** ישות חדשה המייצגת מורה. כוללת רשימה (`List<Student>`) של סטודנטים המקושרים אליה דרך קשר `OneToMany` (הצד ההפוך של הקשר, `mappedBy = "teacher"`). כוללת מתודות עזר (`addStudent`, `removeStudent`) לניהול הקשר הדו-כיווני.

5.  **קומת אובייקטי העברת נתונים (DTOs):**
    * `StudentDto`: עודכן לכלול אובייקט `TeacherBasicDto` לייצוג המורה המשויך.
    * `StudentDetailsDto`: ללא שינוי.
    * **`TeacherDto` (חדש):** DTO להעברת נתוני מורה, כולל רשימה של מזהי הסטודנטים (`List<Long> studentIds`) המשויכים אליו.
    * **`TeacherBasicDto` (חדש):** DTO פשוט יותר למורה (ללא רשימת הסטודנטים), משמש בתוך `StudentDto`.

6.  **קומת המתרגמים (Mappers):**
    * `StudentMapper`: עודכן לטפל בהמרת המידע על המורה המשויך.
    * **`TeacherMapper` (חדש):** ממיר בין `Teacher` (ישות) ל-`TeacherDto`/`TeacherBasicDto`.

7.  **טיפול בשגיאות (Exceptions) ותגובות סטנדרטיות (Response):**
    * המנגנונים הקיימים ממשיכים לפעול ללא שינוי מהותי.

8.  **אתחול נתונים (DataInitializer):**
    * עודכן ליצור נתוני מורים ולקשר חלק מהסטודנטים למורים אלו.

## טכנולוגיות עיקריות:

הטכנולוגיות נשארות זהות לשלבים הקודמים.

## מה חדש ב-Stage3 (בהשוואה ל-Stage2):

* **ישות חדשה (`Teacher`):** מידול של מורים במערכת.
* **קשר One-to-Many / Many-to-One:** מימוש קשר דו-כיווני בין `Teacher` (צד ה"אחד") ל-`Student` (צד ה"רבים").
    * הישות `Student` מכילה את המפתח הזר (`teacher_id`) והיא הבעלים של הקשר מצד ה-ManyToOne.
    * הישות `Teacher` משתמשת ב-`mappedBy` כדי לציין שהקשר מנוהל על ידי השדה `teacher` בישות `Student`.
    * כולל מתודות עזר (`addStudent`, `removeStudent`) בישות `Teacher` לניהול סינכרוני של שני צידי הקשר.
* **DTOs ו-Mappers חדשים/מורחבים:** `TeacherDto`, `TeacherBasicDto`, `TeacherMapper` ועדכונים ל-`StudentDto` ו-`StudentMapper`.
* **Controller ושירות חדשים:** `TeacherController` ו-`TeacherServiceImpl`.
* **פונקציונליות API מורחבת:**
    * יצירה, קריאה, עדכון ומחיקה של מורים.
    * שיוך סטודנט למורה.
    * הסרת סטודנט ממורה.
    * קבלת כל הסטודנטים של מורה ספציפי.
    * קבלת המורה של סטודנט ספציפי.
    * קבלת סטודנטים שאינם משויכים לאף מורה.
    * קבלת מורים לפי מקצוע (עם טיפול בפרמטר שאילתה בעברית).
* **שימוש ב-`@ResponseStatus(HttpStatus.NO_CONTENT)`:** עבור נקודות קצה של מחיקה שמחזירות `void`.
* **החזרת `ResponseEntity` עם `StandardResponse`:** עקביות במבנה התגובות מה-API, כולל שימוש ב-`201 Created` עם כותרת `Location` עבור יצירת משאבים.

## לסיכום:

Stage3 מוסיף את הישות `Teacher` ומממש קשר של אחד-לרבים בינה לבין `Student`. שלב זה מרחיב משמעותית את הפונקציונליות של המערכת ומדגים כיצד לנהל קשרים מורכבים יותר בין ישויות, כולל טיפול בשני צידי הקשר בשיטות עזר, וכיצד לחשוף את הפונקציונליות הזו דרך API מתאים.
</div>